{
  "policyUpi": "PC-AZR-STO-665",
  "policyId": "f5a29936-659e-48a8-8110-783411bf6a9c",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure Storage accounts soft delete is disabled",
  "description": "This policy identifies Azure Storage accounts which has soft delete disabled. Azure Storage contains important access logs, financial data, personal and other secret informations which if accidentally deleted by an user or application could cause data loss or data unavailability. It is recommended to enable soft delete setting in Azure Storage accounts.",
  "rule.criteria": "854edc33-62b4-46c0-83a1-2774ae9ae4ff",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-storage-account-list' AND json.rule = deleteRetentionPolicy.blob.enabled is false",
  "recommendation": "1. Log in to the Azure portal\n2. Select 'Storage Accounts'\n3. Select the storage account you need to modify\n4. Select 'Data protection' under 'Blob service'\n5. Enable 'Turn on soft delete for blobs' under 'Recovery'\n6. Enter number of days you want to retain soft deleted data in'Keep deleted blobs for (in days)' field\n7. Click on 'Save'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "Azure Security Benchmark (v3)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS v1.2.0 (Azure)",
    "CIS v1.3.0 (Azure)",
    "CIS v1.3.1 (Azure)",
    "CIS v1.4.0 (Azure)",
    "CSA CCM v.4.0.1",
    "HITRUST v.9.4.2",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "MITRE ATT&CK v10.0",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "PCI DSS v3.2.1"
  ]
}