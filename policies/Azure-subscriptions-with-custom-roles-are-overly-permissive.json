{
  "policyUpi": "PC-AZR-ARM-501",
  "policyId": "40c06b29-589e-4f1f-8c02-8dafdc80cce6",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure subscriptions with custom roles are overly permissive",
  "description": "This policy identifies azure subscriptions with custom roles are overly permissive. Least privilege access rule should be followed and only necessary privileges should be assigned instead of allowing full administrative access",
  "rule.criteria": "aa1e6ee8-89aa-46eb-83a2-c2d8bd925117",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-role-definition' AND json.rule = properties.type equals \"CustomRole\" and properties.assignableScopes[*] contains \"/\" and properties.permissions[*].actions[*] starts with \"*\"",
  "recommendation": "Check the usage of the role identified.\nThrough console we cannot create, update or delete custom role.\nUse below CLI command to delete the role,\n'az role definition delete --name \\\"rolename\\\"'\nNote: Verify impact caused by deleting the role.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Australian Cyber Security Centre (ACSC) Essential Eight",
    "Azure Security Benchmark (v2)",
    "Azure Security Benchmark (v3)",
    "Brazilian Data Protection Law (LGPD)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS v1.2.0 (Azure)",
    "CIS v1.3.0 (Azure)",
    "CIS v1.3.1 (Azure)",
    "CIS v1.4.0 (Azure)",
    "CIS v1.5.0 (Azure) - Level 1",
    "CSA CCM v.4.0.1",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Fedramp (Moderate)",
    "HITRUST v.9.4.2",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0"
  ]
}