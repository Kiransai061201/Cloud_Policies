{
  "policyUpi": "PC-ALL-ALL-868",
  "policyId": "116a3268-9456-4dfb-ae2b-0f630bf3f5ea",
  "policyType": "network",
  "cloudType": "all",
  "severity": "high",
  "name": "Instance affected by SpringShell vulnerability is exposed to network traffic from the internet",
  "description": "This policy identifies Instances installed with the Java Spring Framework version vulnerable to arbitrary code execution (CVE-2022-22963 or CVE-2022-22965) and exposed to network traffic from the internet. It is recommended to upgrade the Java Spring Framework version to the latest version and limit exposure to the internet.\n\nFor details refer:\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22963\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965\n\nNOTE: This policy is effective only when Prisma Compute is enabled in your environment.",
  "rule.criteria": "a51ac66e-b390-420a-a87d-8aee1b000e64",
  "searchModel.query": "network from vpc.flow_record where bytes > 0 AND source.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2022-22963', 'CVE-2022-22965')) AND destination.publicnetwork IN ('Internet IPs', 'Suspicious IPs')",
  "recommendation": "1. Log in to the Cloud Console\n2. Review the identified instance and investigate the network traffic.\n3. Log in to the host and make sure that there are no processes running that indicate a potential compromise.\n4. If this instance is not authorized to process or host Java Spring Framework related services, terminate the services and change the ACL to block outgoing traffic.\n5. If this instance is authorized to use Java Spring Framework related services, Upgrade Java Spring Framework version to latest to fix this vulnerability.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": ""
}